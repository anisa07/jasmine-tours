---
import IntlBaseLayout from "@/layouts/IntlBaseLayout.astro";
import { getPageTranslations, getLocaleStaticPaths } from "@/i18n/i18n";
import { defaultLocale, type Locale } from "@/i18n/config";
import { getEntry } from "astro:content";
import Container from "@/components/layout/Container.astro";
import { Image } from "astro:assets";
import CTASection from "@/components/content/CTASection.astro";
import {
  MessageCircle,
  Instagram,
  Ship,
  Facebook
} from "@lucide/astro";

// Generate static paths for all supported locales
export async function getStaticPaths() {
  return getLocaleStaticPaths();
}

const aboutEntry = await getEntry("about", "about");
const aboutMeData = aboutEntry?.data;

// Get the translation function for this page
const { t } = await getPageTranslations(defaultLocale as Locale, [
  "common",
  "ui",
  "home",
]);
---

<IntlBaseLayout
  locale={defaultLocale}
  pageNS={["common", "ui", "home"]}
  seo={{
    title: aboutMeData?.title
      ? `${aboutMeData.title} | Jasmine Tours`
      : t(
          "seo.about_title",
          "Зара — ваш личный гид по Нидерландам | Индивидуальные экскурсии и путешествия по Амстердаму и всей стране"
        ),
    description:
      aboutMeData?.subtitle ||
      t(
        "seo.about_description",
        "Познакомьтесь с Зарой — вашим личным гидом, который покажет настоящие Нидерланды. Путешествуйте осознанно, открывайте культуру, людей и атмосферу страны"
      ),
  }}
>
  <!-- Hero Section -->
  <section
    class="relative bg-gradient-to-br from-primary/10 via-background to-accent/5 py-20 overflow-hidden"
  >
    <div class="absolute inset-0 bg-gradient-to-br from-primary/5 to-accent/10">
    </div>

    <Container size="lg" class="relative z-10">
      <div class="grid lg:grid-cols-12 gap-12 items-center">
        <!-- Content -->
        <div class="lg:col-span-7 space-y-8 animate-fade-up">
          <div class="space-y-6">
            <h1 class="text-4xl lg:text-6xl font-bold leading-tight">
              <span class="text-foreground"
                >{aboutMeData?.title || "About Me"}</span
              >
            </h1>
            <div class="text-xl lg:text-2xl text-muted-foreground space-y-2">
              <p class="text-foreground font-medium">
                {aboutMeData?.subtitle || "Your personal guide"}
              </p>
            </div>
          </div>

          <div class="prose prose-lg max-w-none text-muted-foreground">
            <div class="whitespace-pre-line">
              {aboutMeData?.introduction || "Welcome to my about page."}
            </div>
          </div>
        </div>

        <!-- Profile Image -->
        <div class="lg:col-span-5 relative animate-fade-up animate-delay-200">
          <div class="relative max-w-md mx-auto">
            <div
              class="absolute inset-0 bg-gradient-to-br from-primary/20 to-accent/20 rounded-2xl transform rotate-3"
            >
            </div>
            <div
              class="relative bg-gradient-to-br from-amber-50 to-orange-100 rounded-2xl p-8 shadow-xl"
            >
              {aboutMeData?.profileImage && <Image
                  src={aboutMeData.profileImage}
                  alt={`${aboutMeData?.title || "Guide"} - Professional Tour Guide`}
                  class="w-full h-80 object-cover rounded-xl shadow-lg"
                  width={400}
                  height={320}
                  format="webp"
                  quality={80}
              />}
              <div
                class="absolute -bottom-4 -right-4 bg-primary text-primary-foreground p-3 rounded-full shadow-lg"
              >
                <Ship class="w-6 h-6" />
              </div>
            </div>
          </div>
          
          <!-- CTA Buttons -->
          <div class="flex flex-col gap-4 pt-8">
            <!-- WhatsApp Button - Primary -->
            <a
              id="about-whatsapp"
              href="https://wa.me/c/31642221525"
              class="btn-primary"
              target="_blank"
              rel="noopener noreferrer"
            >
              <MessageCircle class="w-5 h-5" />
              {t("actions.whatsapp", "Забронировать через WhatsApp")}
            </a>

            <!-- Instagram Button - Outline -->
            <a
              id="about-instagram"
              href="https://www.instagram.com/jasmine.tours.amsterdam"
              class="btn-outline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <Instagram class="w-5 h-5" />
              {t("actions.instagram", "Подписаться в Instagram")}
            </a>

            <!-- Facebook Button - Outline -->
            <a
              id="about-facebook"
              href="https://www.facebook.com/jasmintoursevents/"
              class="btn-outline"
              target="_blank"
              rel="noopener noreferrer"
            >
              <Facebook class="w-5 h-5" />
              {t("actions.facebook", "Следить в Facebook")}
            </a>
          </div>
        </div>
      </div>
    </Container>
  </section>

  <!-- Services Section -->
  {aboutMeData?.services && (
    <section class="py-20">
      <Container size="lg">
        <div class="text-center mb-16">
          <h2 class="text-3xl lg:text-4xl font-bold mb-4">{t("about.services_title", "Мои услуги")}</h2>
          <p class="text-xl text-muted-foreground max-w-2xl mx-auto">
            {t("about.services_description", "Откройте услуги, которые сделают ваше путешествие незабываемым")}
          </p>
        </div>

        <div class="grid md:grid-cols-2 gap-12">
          <!-- Tours Service -->
          {aboutMeData.services.tours && (
            <div class="animate-fade-up">
              <div class="bg-background rounded-2xl p-8 shadow-lg border border-border hover:shadow-xl transition-shadow">
                <div class="mb-6">
                  {typeof aboutMeData.services.tours.image === 'string' ? (
                    <img
                      src={aboutMeData.services.tours.image}
                      alt={aboutMeData.services.tours.title}
                      class="w-full h-48 object-cover rounded-xl"
                      loading="lazy"
                    />
                  ) : (
                    <Image
                      src={aboutMeData.services.tours.image}
                      alt={aboutMeData.services.tours.title}
                      class="w-full h-48 object-cover rounded-xl"
                      width={400}
                      height={192}
                      format="webp"
                      quality={80}
                    />
                  )}
                </div>
                <h3 class="text-2xl font-bold mb-4">{aboutMeData.services.tours.title}</h3>
                <p class="text-muted-foreground leading-relaxed">
                  {aboutMeData.services.tours.description}
                </p>
              </div>
            </div>
          )}

          <!-- Events Service -->
          {aboutMeData.services.events && (
            <div class="animate-fade-up animate-delay-200">
              <div class="bg-background rounded-2xl p-8 shadow-lg border border-border hover:shadow-xl transition-shadow">
                <div class="mb-6">
                  {typeof aboutMeData.services.events.image === 'string' ? (
                    <img
                      src={aboutMeData.services.events.image}
                      alt={aboutMeData.services.events.title}
                      class="w-full h-48 object-cover rounded-xl"
                      loading="lazy"
                    />
                  ) : (
                    <Image
                      src={aboutMeData.services.events.image}
                      alt={aboutMeData.services.events.title}
                      class="w-full h-48 object-cover rounded-xl"
                      width={400}
                      height={192}
                      format="webp"
                      quality={80}
                    />
                  )}
                </div>
                <h3 class="text-2xl font-bold mb-4">{aboutMeData.services.events.title}</h3>
                <p class="text-muted-foreground leading-relaxed">
                  {aboutMeData.services.events.description}
                </p>
              </div>
            </div>
          )}
        </div>
      </Container>
    </section>
  )}

  <!-- Call to Action -->
  <CTASection t={t} locale={defaultLocale} backgroundColor="primary" />
</IntlBaseLayout>
